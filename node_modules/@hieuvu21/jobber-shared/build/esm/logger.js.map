{"version":3,"file":"logger.js","names":["winston","ElasticsearchTransformer","ElasticsearchTransport","esTransformer","logData","winstonLogger","elasticsearchNode","name","level","consoleTransport","transports","Console","handleExceptions","format","combine","colorize","simple","esTransport","transformer","clientOpts","node","maxRetries","requestTimeout","sniffOnStart","logger","createLogger","exitOnError","defaultMeta","service"],"sources":["../../src/logger.ts"],"sourcesContent":["import winston from 'winston';\r\nimport {\r\n  TransformedData,\r\n  LogData,\r\n  ElasticsearchTransformer,\r\n  ElasticsearchTransport,\r\n} from 'winston-elasticsearch';\r\n\r\nconst esTransformer = (logData: LogData): TransformedData => {\r\n  return ElasticsearchTransformer(logData);\r\n};\r\n\r\nexport const winstonLogger = (\r\n  elasticsearchNode: string,\r\n  name: string,\r\n  level: string\r\n) => {\r\n  const consoleTransport = new winston.transports.Console({\r\n    level,\r\n    handleExceptions: true,\r\n    format: winston.format.combine(\r\n      winston.format.colorize(),\r\n      winston.format.simple()\r\n    ),\r\n  });\r\n\r\n  const esTransport: ElasticsearchTransport = new ElasticsearchTransport({\r\n    level,\r\n    transformer: esTransformer,\r\n    clientOpts: {\r\n      node: elasticsearchNode,\r\n      maxRetries: 2,\r\n      requestTimeout: 10000,\r\n      sniffOnStart: false,\r\n    },\r\n  });\r\n\r\n  const logger  = winston.createLogger({\r\n    exitOnError: false,\r\n    defaultMeta: {\r\n      service: name,\r\n    },\r\n    transports: [consoleTransport, esTransport],\r\n  });\r\n\r\n  return logger;\r\n};\r\n"],"mappings":"AAAA,OAAOA,OAAO,MAAM,SAAS;AAC7B,SAGEC,wBAAwB,EACxBC,sBAAsB,QACjB,uBAAuB;AAE9B,MAAMC,aAAa,GAAIC,OAAgB,IAAsB;EAC3D,OAAOH,wBAAwB,CAACG,OAAO,CAAC;AAC1C,CAAC;AAED,OAAO,MAAMC,aAAa,GAAGA,CAC3BC,iBAAyB,EACzBC,IAAY,EACZC,KAAa,KACV;EACH,MAAMC,gBAAgB,GAAG,IAAIT,OAAO,CAACU,UAAU,CAACC,OAAO,CAAC;IACtDH,KAAK;IACLI,gBAAgB,EAAE,IAAI;IACtBC,MAAM,EAAEb,OAAO,CAACa,MAAM,CAACC,OAAO,CAC5Bd,OAAO,CAACa,MAAM,CAACE,QAAQ,CAAC,CAAC,EACzBf,OAAO,CAACa,MAAM,CAACG,MAAM,CAAC,CACxB;EACF,CAAC,CAAC;EAEF,MAAMC,WAAmC,GAAG,IAAIf,sBAAsB,CAAC;IACrEM,KAAK;IACLU,WAAW,EAAEf,aAAa;IAC1BgB,UAAU,EAAE;MACVC,IAAI,EAAEd,iBAAiB;MACvBe,UAAU,EAAE,CAAC;MACbC,cAAc,EAAE,KAAK;MACrBC,YAAY,EAAE;IAChB;EACF,CAAC,CAAC;EAEF,MAAMC,MAAM,GAAIxB,OAAO,CAACyB,YAAY,CAAC;IACnCC,WAAW,EAAE,KAAK;IAClBC,WAAW,EAAE;MACXC,OAAO,EAAErB;IACX,CAAC;IACDG,UAAU,EAAE,CAACD,gBAAgB,EAAEQ,WAAW;EAC5C,CAAC,CAAC;EAEF,OAAOO,MAAM;AACf,CAAC","ignoreList":[]}