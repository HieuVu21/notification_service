import jwt from 'jsonwebtoken';
import { NotAuthorizeError } from './error-handler';
const tokens = ['auth', 'gig', 'seller', 'search', 'buyer', 'message', 'order', 'review'];
export function verifyGatewayRequest(req, res, next) {
  var _req$headers, _req$headers2;
  if (!((_req$headers = req.headers) != null && _req$headers.gatewayToken)) {
    throw new NotAuthorizeError('invalid request', 'request not coming from api gateway');
  }
  const token = (_req$headers2 = req.headers) == null ? void 0 : _req$headers2.gatewayToken;
  if (!token) {
    throw new NotAuthorizeError('invalid request', 'request not coming from api gateway');
  }
  try {
    const payload = jwt.verify(token, '');
    if (!token.includes(payload.id)) {
      throw new NotAuthorizeError('invalid request', 'payload invalid');
    }
  } catch (error) {
    throw new NotAuthorizeError('invalid request', 'request not coming from api gateway');
  }
}
//# sourceMappingURL=gateway-middleware.js.map