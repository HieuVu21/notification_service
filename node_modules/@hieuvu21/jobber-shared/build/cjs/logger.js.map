{"version":3,"file":"logger.js","names":["_winston","_interopRequireDefault","require","_winstonElasticsearch","e","__esModule","default","esTransformer","logData","ElasticsearchTransformer","winstonLogger","elasticsearchNode","name","level","consoleTransport","winston","transports","Console","handleExceptions","format","combine","colorize","simple","esTransport","ElasticsearchTransport","transformer","clientOpts","node","maxRetries","requestTimeout","sniffOnStart","logger","createLogger","exitOnError","defaultMeta","service","exports"],"sources":["../../src/logger.ts"],"sourcesContent":["import winston from 'winston';\r\nimport {\r\n  TransformedData,\r\n  LogData,\r\n  ElasticsearchTransformer,\r\n  ElasticsearchTransport,\r\n} from 'winston-elasticsearch';\r\n\r\nconst esTransformer = (logData: LogData): TransformedData => {\r\n  return ElasticsearchTransformer(logData);\r\n};\r\n\r\nexport const winstonLogger = (\r\n  elasticsearchNode: string,\r\n  name: string,\r\n  level: string\r\n) => {\r\n  const consoleTransport = new winston.transports.Console({\r\n    level,\r\n    handleExceptions: true,\r\n    format: winston.format.combine(\r\n      winston.format.colorize(),\r\n      winston.format.simple()\r\n    ),\r\n  });\r\n\r\n  const esTransport: ElasticsearchTransport = new ElasticsearchTransport({\r\n    level,\r\n    transformer: esTransformer,\r\n    clientOpts: {\r\n      node: elasticsearchNode,\r\n      maxRetries: 2,\r\n      requestTimeout: 10000,\r\n      sniffOnStart: false,\r\n    },\r\n  });\r\n\r\n  const logger  = winston.createLogger({\r\n    exitOnError: false,\r\n    defaultMeta: {\r\n      service: name,\r\n    },\r\n    transports: [consoleTransport, esTransport],\r\n  });\r\n\r\n  return logger;\r\n};\r\n"],"mappings":";;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,qBAAA,GAAAD,OAAA;AAK+B,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE/B,MAAMG,aAAa,GAAIC,OAAgB,IAAsB;EAC3D,OAAO,IAAAC,8CAAwB,EAACD,OAAO,CAAC;AAC1C,CAAC;AAEM,MAAME,aAAa,GAAGA,CAC3BC,iBAAyB,EACzBC,IAAY,EACZC,KAAa,KACV;EACH,MAAMC,gBAAgB,GAAG,IAAIC,gBAAO,CAACC,UAAU,CAACC,OAAO,CAAC;IACtDJ,KAAK;IACLK,gBAAgB,EAAE,IAAI;IACtBC,MAAM,EAAEJ,gBAAO,CAACI,MAAM,CAACC,OAAO,CAC5BL,gBAAO,CAACI,MAAM,CAACE,QAAQ,CAAC,CAAC,EACzBN,gBAAO,CAACI,MAAM,CAACG,MAAM,CAAC,CACxB;EACF,CAAC,CAAC;EAEF,MAAMC,WAAmC,GAAG,IAAIC,4CAAsB,CAAC;IACrEX,KAAK;IACLY,WAAW,EAAElB,aAAa;IAC1BmB,UAAU,EAAE;MACVC,IAAI,EAAEhB,iBAAiB;MACvBiB,UAAU,EAAE,CAAC;MACbC,cAAc,EAAE,KAAK;MACrBC,YAAY,EAAE;IAChB;EACF,CAAC,CAAC;EAEF,MAAMC,MAAM,GAAIhB,gBAAO,CAACiB,YAAY,CAAC;IACnCC,WAAW,EAAE,KAAK;IAClBC,WAAW,EAAE;MACXC,OAAO,EAAEvB;IACX,CAAC;IACDI,UAAU,EAAE,CAACF,gBAAgB,EAAES,WAAW;EAC5C,CAAC,CAAC;EAEF,OAAOQ,MAAM;AACf,CAAC;AAACK,OAAA,CAAA1B,aAAA,GAAAA,aAAA","ignoreList":[]}